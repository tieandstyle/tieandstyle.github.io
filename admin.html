<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Admin Dashboard - Order Management</title>
<link rel="manifest" href="manifest.json"/>
<meta name="theme-color" content="#df20df"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet"/>
<script>
    tailwind.config = {
        darkMode: "class",
        theme: {
            extend: {
                colors: {
                    "primary": "#df20df",
                    "background-light": "#f8f6f8",
                    "background-dark": "#211121",
                },
                fontFamily: {
                    "display": ["Plus Jakarta Sans", "sans-serif"]
                }
            },
        },
    }
</script>
<style>
.stat-card {
  transition: transform 0.2s;
}
.stat-card:hover {
  transform: translateY(-4px);
}
</style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-black dark:text-white">

<!-- Login Screen -->
<div id="loginScreen" class="min-h-screen flex items-center justify-center px-4">
  <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl p-8 w-full max-w-md">
    <div class="text-center mb-8">
      <h1 class="text-3xl font-bold text-primary mb-2">ğŸ” Admin Login</h1>
      <p class="text-gray-600 dark:text-gray-400">Enter your credentials to access the dashboard</p>
    </div>
    <form id="loginForm" onsubmit="handleLogin(event)" class="space-y-6">
      <div>
        <label class="block text-sm font-medium mb-2" for="adminEmail">Email</label>
        <input 
          type="email" 
          id="adminEmail" 
          class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-background-dark focus:ring-2 focus:ring-primary focus:border-transparent" 
          placeholder="admin@example.com"
          required
        />
      </div>
      <div>
        <label class="block text-sm font-medium mb-2" for="adminPassword">Password</label>
        <input 
          type="password" 
          id="adminPassword" 
          class="w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-background-dark focus:ring-2 focus:ring-primary focus:border-transparent" 
          placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
          required
        />
      </div>
      <button 
        type="submit" 
        class="w-full bg-primary text-white font-bold py-3 rounded-lg hover:bg-primary/90 transition-all"
        id="loginBtn"
      >
        Login
      </button>
      <p class="text-xs text-center text-gray-500 dark:text-gray-400 mt-4">
        Default: admin@tiestyle.com / admin123
      </p>
    </form>
  </div>
</div>

<!-- Dashboard -->
<div id="dashboardScreen" class="hidden min-h-screen">
  <!-- Header -->
  <header class="bg-white dark:bg-background-dark border-b border-gray-200 dark:border-gray-700 sticky top-0 z-20">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center gap-3">
          <h1 class="text-xl font-bold text-primary">ğŸ“Š Admin Dashboard</h1>
        </div>
        <div class="flex items-center gap-4">
          <button onclick="refreshData()" class="p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
            </svg>
          </button>
          <button onclick="handleLogout()" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">
            Logout
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Navigation Tabs -->
    <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg mb-8 overflow-hidden">
      <nav class="flex border-b border-gray-200 dark:border-gray-700">
        <button onclick="switchTab('orders')" id="ordersTab" class="flex-1 px-6 py-4 text-sm font-medium border-b-2 border-primary text-primary">
          ğŸ“¦ All Orders
        </button>
        <button onclick="switchTab('abroad')" id="abroadTab" class="flex-1 px-6 py-4 text-sm font-medium border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600">
          ğŸŒ Abroad Orders
        </button>
        <button onclick="switchTab('analytics')" id="analyticsTab" class="flex-1 px-6 py-4 text-sm font-medium border-b-2 border-transparent hover:border-gray-300 dark:hover:border-gray-600">
          ğŸ“ˆ Analytics
        </button>
      </nav>
    </div>

    <!-- Stats Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6 mb-8">
      <div class="stat-card bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg p-6 shadow-lg">
        <div class="flex items-center justify-between mb-2">
          <p class="text-sm opacity-90">Today's Orders</p>
          <span class="text-2xl">ğŸ“¦</span>
        </div>
        <p class="text-3xl font-bold" id="todayOrdersCount">0</p>
      </div>
      
      <div class="stat-card bg-gradient-to-br from-indigo-500 to-indigo-600 text-white rounded-lg p-6 shadow-lg">
        <div class="flex items-center justify-between mb-2">
          <p class="text-sm opacity-90">Abroad Orders</p>
          <span class="text-2xl">ğŸŒ</span>
        </div>
        <p class="text-3xl font-bold" id="abroadOrdersCount">0</p>
      </div>
      
      <div class="stat-card bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg p-6 shadow-lg">
        <div class="flex items-center justify-between mb-2">
          <p class="text-sm opacity-90">Today's Revenue</p>
          <span class="text-2xl">ğŸ’°</span>
        </div>
        <p class="text-3xl font-bold" id="todayRevenue">â‚¹0</p>
      </div>
      
      <div class="stat-card bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-lg p-6 shadow-lg">
        <div class="flex items-center justify-between mb-2">
          <p class="text-sm opacity-90">Pending Orders</p>
          <span class="text-2xl">â³</span>
        </div>
        <p class="text-3xl font-bold" id="pendingOrdersCount">0</p>
      </div>
      
      <div class="stat-card bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-lg p-6 shadow-lg">
        <div class="flex items-center justify-between mb-2">
          <p class="text-sm opacity-90">Total Customers</p>
          <span class="text-2xl">ğŸ‘¥</span>
        </div>
        <p class="text-3xl font-bold" id="totalCustomers">0</p>
      </div>
    </div>

    <!-- Filters and Search -->
    <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6 mb-8">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="block text-sm font-medium mb-2">Search by Phone</label>
          <input 
            type="tel" 
            id="phoneSearch" 
            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-background-dark focus:ring-2 focus:ring-primary focus:border-transparent" 
            placeholder="+91..."
            oninput="searchByPhone()"
          />
        </div>
        <div>
          <label class="block text-sm font-medium mb-2">Filter by Status</label>
          <select 
            id="statusFilter" 
            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-background-dark focus:ring-2 focus:ring-primary focus:border-transparent"
            onchange="filterOrders()"
          >
            <option value="all">All Orders</option>
            <option value="today">Today's Orders</option>
            <option value="pending">Pending</option>
            <option value="processing">Processing</option>
            <option value="completed">Completed</option>
            <option value="cancelled">Cancelled</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-2">Date Range</label>
          <select 
            id="dateFilter" 
            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-background-dark focus:ring-2 focus:ring-primary focus:border-transparent"
            onchange="filterOrders()"
          >
            <option value="all">All Time</option>
            <option value="today" selected>Today</option>
            <option value="week">This Week</option>
            <option value="month">This Month</option>
          </select>
        </div>
      </div>
    </div>

    <!-- Orders Table -->
    <div id="ordersView" class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden">
      <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-700">
        <h2 class="text-xl font-bold">ğŸ“‹ Orders</h2>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50 dark:bg-gray-800">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Order ID</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Customer</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Phone</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Items</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Total</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Payment</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Date</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="ordersTableBody">
            <tr>
              <td colspan="9" class="px-6 py-12 text-center text-gray-500 dark:text-gray-400">
                Loading orders...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Analytics View -->
    <div id="analyticsView" class="hidden space-y-8">
      <!-- Analytics Filters -->
      <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div>
            <label class="block text-sm font-medium mb-2">ğŸ“… Date Range</label>
            <select 
              id="analyticsDateFilter" 
              class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-background-dark focus:ring-2 focus:ring-primary focus:border-transparent"
              onchange="updateAnalytics()"
            >
              <option value="today">Today</option>
              <option value="week">This Week</option>
              <option value="month" selected>This Month</option>
              <option value="all">All Time</option>
            </select>
          </div>
          <div class="col-span-2 flex items-end">
            <div class="grid grid-cols-3 gap-4 w-full">
              <div class="bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg p-4">
                <p class="text-xs opacity-90 mb-1">Total Revenue</p>
                <p class="text-2xl font-bold" id="analyticsRevenue">â‚¹0</p>
              </div>
              <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg p-4">
                <p class="text-xs opacity-90 mb-1">Total Orders</p>
                <p class="text-2xl font-bold" id="analyticsOrders">0</p>
              </div>
              <div class="bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-lg p-4">
                <p class="text-xs opacity-90 mb-1">Avg Order Value</p>
                <p class="text-2xl font-bold" id="analyticsAvgOrder">â‚¹0</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Revenue Chart -->
      <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6">
        <h3 class="text-xl font-bold mb-4">ğŸ’° Revenue Over Time</h3>
        <canvas id="revenueChart" class="w-full" style="max-height: 400px;"></canvas>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Top Products -->
        <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6">
          <h3 class="text-xl font-bold mb-4">ğŸ† Top Selling Products</h3>
          <div id="topProductsList" class="space-y-4">
            <p class="text-gray-500 dark:text-gray-400">Loading...</p>
          </div>
        </div>

        <!-- Order Status Distribution -->
        <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6">
          <h3 class="text-xl font-bold mb-4">ğŸ“Š Order Status</h3>
          <canvas id="statusChart" class="w-full" style="max-height: 300px;"></canvas>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Payment Status -->
        <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6">
          <h3 class="text-xl font-bold mb-4">ğŸ’³ Payment Status</h3>
          <canvas id="paymentChart" class="w-full" style="max-height: 300px;"></canvas>
        </div>

        <!-- Recent Customers -->
        <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6">
          <h3 class="text-xl font-bold mb-4">ğŸ‘¥ Recent Customers</h3>
          <div id="recentCustomersList" class="space-y-3">
            <p class="text-gray-500 dark:text-gray-400">Loading...</p>
          </div>
        </div>
      </div>

      <!-- Sales by Date -->
      <div class="bg-white dark:bg-background-dark border border-gray-200 dark:border-gray-700 rounded-lg p-6">
        <h3 class="text-xl font-bold mb-4">ğŸ“… Sales by Date</h3>
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead class="bg-gray-50 dark:bg-gray-800">
              <tr>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400">Date</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400">Orders</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400">Revenue</th>
                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400">Avg Order</th>
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200 dark:divide-gray-700" id="salesByDateTable">
              <tr>
                <td colspan="4" class="px-4 py-8 text-center text-gray-500 dark:text-gray-400">Loading...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Order Details Modal -->
<div id="orderModal" class="fixed inset-0 bg-black/50 z-50 hidden items-center justify-center p-4" onclick="if(event.target===this) closeOrderModal()">
  <div class="bg-white dark:bg-background-dark rounded-lg shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-auto">
    <div class="sticky top-0 bg-white dark:bg-background-dark border-b border-gray-200 dark:border-gray-700 px-6 py-4 flex items-center justify-between">
      <h3 class="text-xl font-bold">Order Details</h3>
      <button onclick="closeOrderModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>
    </div>
    <div class="p-6" id="orderModalContent">
      Loading...
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script type="module" src="js/admin.js"></script>
</body>
</html>
